---
title: "Heist - HackTheBox"
layout: single
excerpt: "Esta es una máquina fácil, para su intrusión encontré credenciales en una ruta del servidor web, las utilice para dumpear más usuarios con lookupsid.py, con el usuario Chase me autentique con una contraseña craqueada en evil-winrm, para la escalada de privilegios dumpee un proceso de Firefox con procdump64.exe y filtre en el volcado por login.php y me reporto credenciales de acceso con Administrador."
header:
show_date: true
classes: wide
header:
  teaser: "https://user-images.githubusercontent.com/69093629/126850695-3236b01e-bdbb-404a-b1a1-46f1dd15ed75.png"
  teaser_home_page: true
  icon: "https://user-images.githubusercontent.com/69093629/125662338-fd8b3b19-3a48-4fb0-b07c-86c047265082.png"
categories:
  - HackTheBox
tags:
  - firefox
  - procdump64.exe
  - evil-winrm
  - lookupsid.py
---

![image (28)](https://user-images.githubusercontent.com/69093629/126850695-3236b01e-bdbb-404a-b1a1-46f1dd15ed75.png)

Empece haciendo un escaneo con `Nmap` para detectar los puertos y servicios que tiene abiertos la maquina.

![nmap1](https://user-images.githubusercontent.com/69093629/126850732-20a2ff50-7dad-4aba-bafb-7c1f101ad833.png)

Viendo que hay un servidor web, me dirigi a él.

![pagina](https://user-images.githubusercontent.com/69093629/126850775-2f65920f-316a-4802-a390-820c880ec4a2.png)

Tenia un panel de `login`, miré el codigo fuente y me di cuenta que habian unas rutas que me llamaron mucho la atencion.

![paginamenaje](https://user-images.githubusercontent.com/69093629/126850819-cd42c4a6-e429-4262-829c-1f8fd04a9b45.png)

Era una conversacion entre un usuario y el `admin`, el usuario le dejaba un link que tenia otra ruta, mire que tenia.

![contraseñaencriptada](https://user-images.githubusercontent.com/69093629/126850852-044365eb-3f3f-4a27-b38e-7834f9d34fc2.png)

Tenia unos cuantos hashes, pense que podrian ser credenciales para el `login` de la pagina principal, crackee el primero con `john the ripper`.

![contraseñacrackeada](https://user-images.githubusercontent.com/69093629/126850911-6ac365e8-fad1-4a32-a6c4-13013b49ec2f.png)

Valide el usuario `hazard` que tenia una conversacion con el `admin` y la credencial crackeada con `crackmapexec` y resulto ser exitosa.

![intentodesmbclient](https://user-images.githubusercontent.com/69093629/126851464-991d201a-473d-4003-96a0-1a1f924875f3.png)

Probe distintos usuarios en el panel de `login` pero no hubo suerte, tambien intente ver si tenia acceso a algun recurso compartido con `smbclient` pero no encontre nada.

![intentodesmbclient](https://user-images.githubusercontent.com/69093629/126851397-b9fea407-265a-42cd-b4b2-e7549af64b19.png)

Pense en otra alternativa, intente dumpeear mas usuarios con el usuario `hazard` y la contraseña crackeada con `john` haciendo uso de la herramienta `lookupsid.py`.

![usodelookupsid](https://user-images.githubusercontent.com/69093629/126850981-bc0420c1-02c7-4f84-969a-9b33ed53973e.png)

Me dumpeeo unos cuantos, con los que tenia me cree un diccionario de usuarios para hacer fuerza bruta con otra contraseña crackeada de otro `hash`.

![crackpassword](https://user-images.githubusercontent.com/69093629/126851207-714391ca-d5f0-40b3-ab84-93028d6df85a.png)

Para la fuera bruta hice uso de la herramienta `crackmapexec`, me detecto que el usuario `Chase` era valido.

![credencialultima](https://user-images.githubusercontent.com/69093629/126851241-b8603f35-b371-4bd0-a5d1-02f0e678db17.png)

Me autentique en `evil-winrm` y ya pude visualizar la flag del usuario.

![flagdeuser](https://user-images.githubusercontent.com/69093629/126851289-0400bf1e-016c-4972-84b3-6497261453f0.jpg)

Para la escalada de privilegios encontré procesos de Firefox corriendo en el sistema.

![findstr](https://user-images.githubusercontent.com/69093629/126851324-2bc5a76f-1395-46a0-8281-504efba8da70.png)

Me transferi la utilidad `procdump64.exe` e hice un volcado a un proceso de Firefox.

![procdump](https://user-images.githubusercontent.com/69093629/126851553-49029543-9416-4f31-a570-ba723a913da4.png)

Al volcado le hice un strings y lo exporte a un archivo llamado `cred.txt`, filtre por `login.php` y me reporto unas credenciales, probe a validarlas con `crackmapexec` haciendo uso del usuario `Administrator`.

![pnwed](https://user-images.githubusercontent.com/69093629/126851662-aa62dce3-e58d-4993-b0a7-bb41b2cb3262.png)

Dio `pwned` eso me permitio acceder con `psexec` con los maximos prilegios.

![psexec](https://user-images.githubusercontent.com/69093629/126851700-a4776f26-f746-472d-88ba-5fe5a7fb531f.png)

Tambien pude acceder con `evil-winrm`.

![evilwinrmadmin+](https://user-images.githubusercontent.com/69093629/126851727-b4ed1645-b448-4625-be1f-d576f7a1475c.png)







